diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 7983c7c..df504bb 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -1,6 +1,8 @@
 name: CI
 
 on:
+  push:
+    branches: ["main"]
   pull_request:
   workflow_dispatch:
 
@@ -25,7 +27,7 @@ jobs:
     timeout-minutes: 25
     strategy:
       matrix:
-        python-version: ["3.11"]
+        python-version: ["3.10", "3.11", "3.12"]
     steps:
       - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4
       - uses: actions/setup-python@82c7e631bb3cdc910f68e0081d67478d79c6982d # v5
@@ -50,7 +52,7 @@ jobs:
         uses: actions/upload-artifact@65462800fd760344b1a7b4382951275a0abb4808 # v4
         with:
           name: validation-and-eval-${{ matrix.python-version }}
-          if-no-files-found: error
+          if-no-files-found: warn
           path: |
             artifacts/reports/**
             objects/*/artifacts/evidence/reference/eval/report.json
diff --git a/MANIFEST.json b/MANIFEST.json
index 9147bb5..cd5ad73 100644
--- a/MANIFEST.json
+++ b/MANIFEST.json
@@ -145,7 +145,7 @@
       "sha256": "7396b398eead8d78d36007a9c2c2296fdfdb37565190e1a581a900c0f75ff405"
     },
     ".github/workflows/ci.yml": {
-      "sha256": "daa749480e28dab5e2006c44edd07894b0cba1ec9d48acaba8a8af6fb0ec9eb8"
+      "sha256": "1a2f43cfc634f29964bc25941dabe47bf9066fd077cd57a639684cb5a893becb"
     },
     ".github/workflows/lint-actions.yml": {
       "sha256": "6b4eacb9a1daa39a8722c8d825fddc6b18dc6d9b3eff2a26bf48367438c2e937"
@@ -169,7 +169,7 @@
       "sha256": "1126322e2cc8d165adc4c792eeb195717de2bcc7b39be1ce77959d78e87ef685"
     },
     "Makefile": {
-      "sha256": "a06bf1375008736eb0763074f5d76d68b843cea10bff797f79278583f77cfd0d"
+      "sha256": "ec42203d783f4098721eb816ceb8f71ee0dc2a635e33d9bbc96e228f3122746c"
     },
     "README.md": {
       "sha256": "1ec07e23faab75f66de5ffb2b12554665d6527ffa91b288136809b73c6b036c0"
@@ -310,7 +310,7 @@
       "sha256": "5f9a161f1c399de0cc3ea69e97046879473f5debf71dedfa99a036bd2aca77e6"
     },
     "exoneural_governor/cli.py": {
-      "sha256": "990ec99bb30a4e7a172d5ac79f3d2cdfca3d143afb76e5c37faebc325196ce27"
+      "sha256": "b2fe4b6cd56244909fbbb2db87cd2884517fe964e78027adb495b8b1533754cd"
     },
     "exoneural_governor/config.py": {
       "sha256": "498d8d448cfe8ab623d5ac0e329eb4499cc99cee21fd3635163b3af0c25c1dda"
@@ -334,7 +334,7 @@
       "sha256": "8731ba0fda88225b5117e2b8c63e7278169b573a66692fc2f465fd26c0db3581"
     },
     "exoneural_governor/vr.py": {
-      "sha256": "0ac28a22d06dd1a7c08b6a621a95d6247d419444548704f6b7b9e47b21aa0b10"
+      "sha256": "41145ea1f1454f801dc034513fcc852ddedd93fbac1fefccab5553d9842cfe27"
     },
     "objects/dse-fix-opt/CHANGELOG.md": {
       "sha256": "bb6b7628c1ecdbc925145c11ba0c801d319485e120b653d15cce0bb3f1e5798f"
@@ -418,7 +418,7 @@
       "sha256": "10d8d54318449dc76afbb54f37570f85e8cad8fc648d9dbc2cf658a84677ea6a"
     },
     "pyproject.toml": {
-      "sha256": "65c5c8de1857a8a4c45488ab63cd3e2ff632140d8e1b7a4c2316bcee6088695e"
+      "sha256": "ff868b3671415ff7bccca0bf514cda1a14415873cdfc01c1aba189542d850549"
     },
     "reports/production-readiness-verified-2026-02-20.md": {
       "sha256": "bc0299089166088626586aea35242d382442892559a115cdcb1473674eae1e4a"
@@ -514,13 +514,13 @@
       "sha256": "206e03129e75f5e78bb52c00e15dcd0801d5bd6b1ed57f368d912691dd1fb6b8"
     },
     "tests/test_repo_invariants.py": {
-      "sha256": "e9234f9f66325028c9d3f9cb4b5058cd8afe306b0dd713954e39e2dddf6a3acf"
+      "sha256": "4bb53fac5e0117de057871d7368632025f42a0dbc4374bef4e529d682a3259ea"
     },
     "tests/test_secret_scan_gate.py": {
       "sha256": "c888f28ee1a60172e9c9ec13e2f5377116d71485ced8df285e0c45f4062274b5"
     },
     "tests/test_stack.py": {
-      "sha256": "8d44a31c5140fdea9f73d1cefd2ee61a2105096ec8809b859d49ad2453e1982f"
+      "sha256": "0c8517b9a705b84344eff64f054043c7c98a01c51535f2ac4e94833b6220ef53"
     },
     "tests/test_titan9_inventory.py": {
       "sha256": "9765cc81b1df57b7e18f87c569211a26870866c65b3a0af1bb83b77a2031f1a8"
@@ -568,7 +568,7 @@
       "sha256": "83680a918bb97e97d90a386e78541d00e4f11a2bf2aca62237e07b4977f6c530"
     },
     "tools/secret_scan_gate.py": {
-      "sha256": "dce0e94936aab41075fea5067ef02f99082e2c9d524ea39a6aed2a9fcb6e7790"
+      "sha256": "7b232e46fc526c96b6a924158e74bcafc625f0f66d0d0a994c1c4b73d1b3db2f"
     },
     "tools/titan9_inventory.py": {
       "sha256": "3005644b1f02e53dc76b786c365f8cab1c5509830bd88db2ae3d75d7e43f97df"
diff --git a/Makefile b/Makefile
index 0083d02..a74c3fc 100644
--- a/Makefile
+++ b/Makefile
@@ -15,7 +15,7 @@ export PAGER
 
 .PHONY: \
 	setup bootstrap fmt format_check fmt-check lint type typecheck test validate eval evals \
-	protocol inventory readme_contract proof proof-verify check verify all demo ci precommit doctor quickstart clean reset vuln-scan workflow-hygiene action-pinning check_r8
+	protocol inventory readme_contract proof proof-verify check verify all demo ci precommit doctor quickstart clean reset vuln-scan workflow-hygiene action-pinning secret-scan check_r8
 
 setup:
 	python -m pip install -r requirements.lock
@@ -82,7 +82,7 @@ action-pinning:
 check_r8: check
 	python tools/feg_r8_verify.py
 
-check: doctor format_check lint typecheck test validate evals protocol inventory readme_contract workflow-hygiene action-pinning
+check: doctor format_check lint typecheck test validate evals protocol inventory readme_contract workflow-hygiene action-pinning secret-scan
 
 verify: check
 
@@ -103,3 +103,6 @@ all: setup check proof
 ci: check
 
 precommit: format_check lint typecheck test
+
+secret-scan:
+	python tools/secret_scan_gate.py --repo-root . --out artifacts/security/secret-scan.json
diff --git a/artifacts/titan9/hashes.json b/artifacts/titan9/hashes.json
index b2ed9e3..da28ace 100644
--- a/artifacts/titan9/hashes.json
+++ b/artifacts/titan9/hashes.json
@@ -1,6 +1,6 @@
 {
   "README.md": "1ec07e23faab75f66de5ffb2b12554665d6527ffa91b288136809b73c6b036c0",
-  "artifacts/titan9/inventory.json": "f3b9fae855951c0dfe04cd0def7735b1ef73a4e1cf1f6b8daae30898f233175e",
+  "artifacts/titan9/inventory.json": "43efd8d4af2fb4193b0891b79ea7ec410040c4655a33ec8a7c036bb3781422bd",
   "artifacts/titan9/readme_commands.json": "3218e977a8363052b510d078ed2d4edd2b82bc59e894a83fe1254f2a604f015d",
   "docs/SPEC.md": "c9ac37023740a231ebe057dcfb60b16c5398dcfc695f9b8c8ebf77765ce8c3ad"
 }
diff --git a/artifacts/titan9/inventory.json b/artifacts/titan9/inventory.json
index bda2391..fc26309 100644
--- a/artifacts/titan9/inventory.json
+++ b/artifacts/titan9/inventory.json
@@ -42,9 +42,13 @@
       "BASE_SHA='${{ github.event.pull_request.base.sha }}'",
       "HEAD_SHA='${{ github.event.pull_request.head.sha }}'",
       "cat > artifacts/security/pip-audit.json <<'JSON'",
+      "echo \"quality job result was '${{ needs.quality.result }}'\" >&2",
+      "exit 1",
+      "fi",
       "git rev-parse --verify \"$BASE_SHA\"",
       "git rev-parse --verify \"$HEAD_SHA\"",
       "heredoc-body sha256:<normalized:JSON>",
+      "if [ \"${{ needs.quality.result }}\" != \"success\" ]; then",
       "inline-script sha256:43e83f317b5d32d914b40beb1ba9a1f61db3341e40982f472ff1b44073844be6",
       "make check",
       "make proof",
@@ -60,7 +64,6 @@
       "python tools/verify_action_pinning.py",
       "python tools/verify_workflow_hygiene.py",
       "set -euo pipefail",
-      "test \"${{ needs.quality.result }}\" = \"success\"",
       "test \"${{ steps.scorecard.outcome }}\" = \"success\""
     ]
   }
diff --git a/artifacts/titan9/proof.log b/artifacts/titan9/proof.log
index 0428281..e7a9784 100644
--- a/artifacts/titan9/proof.log
+++ b/artifacts/titan9/proof.log
@@ -1,15 +1,15 @@
 === cycle 1 ===
 $ python tools/titan9_inventory.py --repo-root . --out artifacts/titan9/inventory.json
 $ python tools/verify_readme_contract.py --readme README.md --workflows .github/workflows --inventory artifacts/titan9/inventory.json
-f3b9fae855951c0dfe04cd0def7735b1ef73a4e1cf1f6b8daae30898f233175e  artifacts/titan9/inventory.json
+43efd8d4af2fb4193b0891b79ea7ec410040c4655a33ec8a7c036bb3781422bd  artifacts/titan9/inventory.json
 3218e977a8363052b510d078ed2d4edd2b82bc59e894a83fe1254f2a604f015d  artifacts/titan9/readme_commands.json
 === cycle 2 ===
 $ python tools/titan9_inventory.py --repo-root . --out artifacts/titan9/inventory.json
 $ python tools/verify_readme_contract.py --readme README.md --workflows .github/workflows --inventory artifacts/titan9/inventory.json
-f3b9fae855951c0dfe04cd0def7735b1ef73a4e1cf1f6b8daae30898f233175e  artifacts/titan9/inventory.json
+43efd8d4af2fb4193b0891b79ea7ec410040c4655a33ec8a7c036bb3781422bd  artifacts/titan9/inventory.json
 3218e977a8363052b510d078ed2d4edd2b82bc59e894a83fe1254f2a604f015d  artifacts/titan9/readme_commands.json
 === cycle 3 ===
 $ python tools/titan9_inventory.py --repo-root . --out artifacts/titan9/inventory.json
 $ python tools/verify_readme_contract.py --readme README.md --workflows .github/workflows --inventory artifacts/titan9/inventory.json
-f3b9fae855951c0dfe04cd0def7735b1ef73a4e1cf1f6b8daae30898f233175e  artifacts/titan9/inventory.json
+43efd8d4af2fb4193b0891b79ea7ec410040c4655a33ec8a7c036bb3781422bd  artifacts/titan9/inventory.json
 3218e977a8363052b510d078ed2d4edd2b82bc59e894a83fe1254f2a604f015d  artifacts/titan9/readme_commands.json
diff --git a/exoneural_governor/cli.py b/exoneural_governor/cli.py
index e3f07f2..9883790 100644
--- a/exoneural_governor/cli.py
+++ b/exoneural_governor/cli.py
@@ -56,7 +56,11 @@ def cmd_validate(cfg_path: Path) -> int:
 
 def cmd_vr(cfg_path: Path, out_path: Path, write_back: bool) -> int:
     cfg = load_config(cfg_path)
-    vr = run_vr(cfg, write_back=False)
+    try:
+        vr = run_vr(cfg, write_back=False)
+    except ValueError as exc:
+        print(str(exc), file=sys.stderr)
+        return 3
     if write_back:
         target = out_path if out_path.is_absolute() else (cfg.repo_root / out_path)
         target.parent.mkdir(parents=True, exist_ok=True)
diff --git a/exoneural_governor/vr.py b/exoneural_governor/vr.py
index 360f3c1..cbdb0c7 100644
--- a/exoneural_governor/vr.py
+++ b/exoneural_governor/vr.py
@@ -11,7 +11,7 @@ from .config import Config
 from .inventory import inventory
 from .manifest import write_manifest
 from .redaction import load_redaction_patterns, redact_tree
-from .util import sha256_bytes, write_json, run_cmd, ensure_dir
+from .util import ensure_dir, run_cmd, sha256_bytes, utc_now_iso, write_json
 
 
 def _package_version(repo_root: Path) -> str:
@@ -127,7 +127,7 @@ def run_vr(cfg: Config, *, write_back: bool = True) -> dict:
 
     vr: Dict[str, Any] = {
         "schema": "VR-2026.1",
-        "utc": "1970-01-01T00:00:00Z",
+        "utc": utc_now_iso(),
         "status": "RUN",
         "work_id": work_id,
         "evidence_root": str(evidence_root),
diff --git a/pyproject.toml b/pyproject.toml
index 20a787f..098cfb5 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -50,3 +50,4 @@ python_version = "3.11"
 exclude = ["^vendor/", "^objects/.*/eval/"]
 ignore_missing_imports = true
 disable_error_code = ["import-untyped"]
+check_untyped_defs = true
diff --git a/tests/test_repo_invariants.py b/tests/test_repo_invariants.py
index 4e82d5f..fd21d47 100644
--- a/tests/test_repo_invariants.py
+++ b/tests/test_repo_invariants.py
@@ -11,6 +11,11 @@ def run(cmd: list[str]) -> subprocess.CompletedProcess[str]:
     return subprocess.run(cmd, cwd=REPO_ROOT, capture_output=True, text=True)
 
 
+def _in_git_checkout() -> bool:
+    p = run(["git", "rev-parse", "--is-inside-work-tree"])
+    return p.returncode == 0 and p.stdout.strip() == "true"
+
+
 def test_validate_arsenal_strict_passes() -> None:
     p = run(["python", "scripts/validate_arsenal.py", "--repo-root", ".", "--strict"])
     assert p.returncode == 0, p.stdout + "\n" + p.stderr
@@ -27,6 +32,10 @@ def test_object_eval_harnesses_pass() -> None:
 
 
 def test_no_generated_artifacts_tracked() -> None:
+    if not _in_git_checkout():
+        import pytest
+
+        pytest.skip("requires git checkout")
     p = run(["git", "ls-files"])
     assert p.returncode == 0, p.stderr
     tracked = p.stdout.splitlines()
diff --git a/tests/test_stack.py b/tests/test_stack.py
index 4f56d79..f30b9b0 100644
--- a/tests/test_stack.py
+++ b/tests/test_stack.py
@@ -1,5 +1,7 @@
 from __future__ import annotations
 
+import os
+import subprocess
 import sys
 from pathlib import Path
 
@@ -11,14 +13,30 @@ from exoneural_governor.vr import run_vr
 from exoneural_governor.release import build_release
 
 
+def _git_head_available(repo_root: Path) -> bool:
+    probe = subprocess.run(
+        ["git", "rev-parse", "HEAD"],
+        cwd=repo_root,
+        capture_output=True,
+        text=True,
+        check=False,
+    )
+    return probe.returncode == 0
+
+
 def test_catalog_ok():
     repo_root = Path(__file__).resolve().parents[1]
     rep = validate_catalog(repo_root)
     assert rep["ok"], rep
 
 
-def test_vr_and_release(tmp_path):
+def test_vr_and_release(tmp_path, monkeypatch):
     repo_root = Path(__file__).resolve().parents[1]
+    if (
+        not _git_head_available(repo_root)
+        and not os.environ.get("BUILD_ID", "").strip()
+    ):
+        monkeypatch.setenv("BUILD_ID", "nogit-test-build-id")
     cfg = load_config(repo_root / "configs" / "sg.config.json")
     vr = run_vr(cfg, write_back=False)
     assert vr["status"] in ("RUN", "CALIBRATION_REQUIRED")
diff --git a/tools/secret_scan_gate.py b/tools/secret_scan_gate.py
index f94fa3d..0efc6a0 100644
--- a/tools/secret_scan_gate.py
+++ b/tools/secret_scan_gate.py
@@ -15,12 +15,35 @@ PATTERNS: list[tuple[str, re.Pattern[str]]] = [
 ]
 
 
+def _all_files_fallback(repo_root: Path) -> list[Path]:
+    files: list[Path] = []
+    for path in sorted(repo_root.rglob("*")):
+        if not path.is_file():
+            continue
+        rel = path.relative_to(repo_root)
+        if any(
+            part
+            in {
+                ".git",
+                ".venv",
+                "__pycache__",
+                ".pytest_cache",
+                ".ruff_cache",
+                ".mypy_cache",
+            }
+            for part in rel.parts
+        ):
+            continue
+        files.append(path)
+    return files
+
+
 def _tracked_files(repo_root: Path) -> list[Path]:
     p = subprocess.run(
         ["git", "ls-files"], cwd=repo_root, capture_output=True, text=True, check=False
     )
     if p.returncode != 0:
-        raise RuntimeError(p.stderr.strip() or "git ls-files failed")
+        return _all_files_fallback(repo_root)
     return [repo_root / line for line in p.stdout.splitlines() if line.strip()]
 
 
