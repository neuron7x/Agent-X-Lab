name = "axl-bff"
main = "src/index.ts"
compatibility_date = "2024-11-01"
compatibility_flags = ["nodejs_compat"]

[vars]
KV_TTL_SEC = "60"
KV_INDEX_KEY = "__kv_key_index__"
WORKER_VERSION = "1.0.0"

[[kv_namespaces]]
binding = "AXL_KV"
# Fill in during `wrangler kv:namespace create AXL_KV`
# id = "<YOUR_KV_NAMESPACE_ID>"
id = "REPLACE_WITH_YOUR_KV_NAMESPACE_ID"
preview_id = "REPLACE_WITH_YOUR_PREVIEW_KV_NAMESPACE_ID"

# Required Worker secrets (set via `wrangler secret put`):
#   GITHUB_TOKEN        — PAT or fine-grained token
#   WEBHOOK_SECRET      — GitHub webhook shared secret
#   ALLOWED_ORIGINS     — comma-separated e.g. "https://axl.vercel.app,https://axl-qa8.vercel.app"
#   GITHUB_OWNER        — repo owner
#   GITHUB_REPO         — repo name
#   GITHUB_VR_BRANCH    — branch where VR.json is committed, default "vr-state"
#   GITHUB_VR_PATH      — path in repo, default "ad2026_state/vr/latest.json"

# GPT-5.2 Forge
# wrangler secret put OPENAI_API_KEY
# wrangler secret put OPENAI_MODEL       # optional, default: gpt-5.2
# wrangler secret put OPENAI_MAX_TOKENS  # optional, default: 4096

# n8n Forge
# wrangler secret put N8N_WEBHOOK_URL    # e.g. https://your.n8n.cloud/webhook/axl-forge
# wrangler secret put N8N_SECRET         # X-N8N-Secret header

# Auth
# wrangler secret put AXL_API_KEY   # required for POST /dispatch/* and /ai/forge*
