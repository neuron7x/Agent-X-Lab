{
  "observed_failures": [
    {
      "id": "MANIFEST-CHECKSUM-NONDETERMINISM",
      "message": "Checksum rebuild could include untracked or transient artifact files, creating strict-validation drift from clean-checkout CI expectations."
    }
  ],
  "root_cause": "The checksum generator walked the filesystem instead of git-tracked stable files, and strict validation did not enforce a fail-closed tracked/stable contract for checksummed paths.",
  "changes": [
    {
      "file": "scripts/rebuild_checksums.py",
      "rationale": "Generate checksums from git-tracked files and block root artifacts/ paths except explicit object reference evidence allowlist."
    },
    {
      "file": "scripts/validate_arsenal.py",
      "rationale": "Enforce strict checksums to reference only tracked stable files and reject forbidden transient artifacts under artifacts/."
    },
    {
      "file": "tests/test_rebuild_checksums.py",
      "rationale": "Add regression proving untracked files are excluded from checksums while tracked stable files are included."
    },
    {
      "file": "MANIFEST.json",
      "rationale": "Rebuilt deterministic checksums under the hardened selection contract."
    }
  ],
  "gates_run": [
    {
      "command": "python -m pytest -q tests/test_rebuild_checksums.py tests/test_repo_invariants.py tests/test_pip_audit_gate.py",
      "exit_code": 0
    },
    {
      "command": "make check",
      "exit_code": 0
    }
  ],
  "remaining_risks": [],
  "evidence_paths": [
    "artifacts/pr_evidence/report.json",
    "MANIFEST.json"
  ]
}
