...F...F....................F.F.FF.F...F.....FFF........................ [ 98%]
F                                                                        [100%]
=================================== FAILURES ===================================
_____________ test_load_config_rejects_repo_root_without_pyproject _____________

tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/test_load_config_rejects_repo_0')

    def test_load_config_rejects_repo_root_without_pyproject(tmp_path: Path) -> None:
        repo = tmp_path / "repo"
        cfg_dir = repo / "configs"
        cfg_dir.mkdir(parents=True)
    
        schema_src = Path("configs/sg.config.schema.json")
        schema_dst = repo / "configs" / "sg.config.schema.json"
>       schema_dst.write_text(schema_src.read_text(encoding="utf-8"), encoding="utf-8")
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

engine/tests/test_config.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/root/.pyenv/versions/3.13.8/lib/python3.13/pathlib/_local.py:546: in read_text
    return PathBase.read_text(self, encoding, errors, newline)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/root/.pyenv/versions/3.13.8/lib/python3.13/pathlib/_abc.py:632: in read_text
    with self.open(mode='r', encoding=encoding, errors=errors, newline=newline) as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = PosixPath('configs/sg.config.schema.json'), mode = 'r', buffering = -1
encoding = 'utf-8', errors = None, newline = None

    def open(self, mode='r', buffering=-1, encoding=None,
             errors=None, newline=None):
        """
        Open the file pointed to by this path and return a file object, as
        the built-in open() function does.
        """
        if "b" not in mode:
            encoding = io.text_encoding(encoding)
>       return io.open(self, mode, buffering, encoding, errors, newline)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       FileNotFoundError: [Errno 2] No such file or directory: 'configs/sg.config.schema.json'

/root/.pyenv/versions/3.13.8/lib/python3.13/pathlib/_local.py:537: FileNotFoundError
_________________ test_quickstart_script_exists_and_executable _________________

    def test_quickstart_script_exists_and_executable() -> None:
        path = REPO_ROOT / "scripts/quickstart.sh"
        assert path.exists()
>       assert path.stat().st_mode & 0o111
E       AssertionError: assert (33188 & 73)
E        +  where 33188 = os.stat_result(st_mode=33188, st_ino=3015780, st_dev=65024, st_nlink=1, st_uid=0, st_gid=0, st_size=585, st_atime=1772261880, st_mtime=1772261879, st_ctime=1772261879).st_mode
E        +    where os.stat_result(st_mode=33188, st_ino=3015780, st_dev=65024, st_nlink=1, st_uid=0, st_gid=0, st_size=585, st_atime=1772261880, st_mtime=1772261879, st_ctime=1772261879) = stat()
E        +      where stat = PosixPath('/workspace/Agent-X-Lab/engine/scripts/quickstart.sh').stat

engine/tests/test_doctor.py:22: AssertionError
_________________________ test_readme_contract_passes __________________________

    def test_readme_contract_passes() -> None:
        inv = run(
            [
                "python",
                "tools/titan9_inventory.py",
                "--repo-root",
                ".",
                "--out",
                "artifacts/titan9/inventory.json",
            ]
        )
        assert inv.returncode == 0, inv.stdout + "\n" + inv.stderr
    
        p = run(
            [
                "python",
                "tools/verify_readme_contract.py",
                "--readme",
                "README.md",
                "--workflows",
                ".github/workflows",
                "--inventory",
                "artifacts/titan9/inventory.json",
            ]
        )
>       assert p.returncode == 0, p.stdout + "\n" + p.stderr
E       AssertionError: 
E         README commands are not represented in workflow/inventory canonical set: make check, make proof, make setup
E         
E       assert 1 == 0
E        +  where 1 = CompletedProcess(args=['python', 'tools/verify_readme_contract.py', '--readme', 'README.md', '--workflows', '.github/w...stderr='README commands are not represented in workflow/inventory canonical set: make check, make proof, make setup\n').returncode

engine/tests/test_readme_contract.py:55: AssertionError
______________________ test_generate_titan9_proof_bundle _______________________

    def test_generate_titan9_proof_bundle() -> None:
        p = run(["python", "tools/generate_titan9_proof.py", "--repo-root", "."])
>       assert p.returncode == 0, p.stdout + "\n" + p.stderr
E       AssertionError: 
E         
E       assert 1 == 0
E        +  where 1 = CompletedProcess(args=['python', 'tools/generate_titan9_proof.py', '--repo-root', '.'], returncode=1, stdout='', stderr='').returncode

engine/tests/test_readme_contract.py:123: AssertionError
___________ test_rebuild_checksums_excludes_transient_artifact_paths ___________

tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/test_rebuild_checksums_exclude0')

    def test_rebuild_checksums_excludes_transient_artifact_paths(tmp_path: Path) -> None:
        subprocess.run(
            ["git", "init"], cwd=tmp_path, check=True, capture_output=True, text=True
        )
        subprocess.run(
            ["git", "config", "user.email", "test@example.com"],
            cwd=tmp_path,
            check=True,
            capture_output=True,
            text=True,
        )
        subprocess.run(
            ["git", "config", "user.name", "Test User"],
            cwd=tmp_path,
            check=True,
            capture_output=True,
            text=True,
        )
    
        (tmp_path / "artifacts/security").mkdir(parents=True)
        (tmp_path / "artifacts/titan9").mkdir(parents=True)
        (tmp_path / "artifacts/reports").mkdir(parents=True)
        (tmp_path / "objects/x/artifacts/evidence/reference/eval").mkdir(parents=True)
        (tmp_path / "src").mkdir(parents=True)
    
        (tmp_path / "src/stable.txt").write_text("stable\n", encoding="utf-8")
        (tmp_path / "artifacts/security/pip-audit.json").write_text(
            "{}\n", encoding="utf-8"
        )
        (tmp_path / "artifacts/titan9/proof.log").write_text("proof\n", encoding="utf-8")
        (tmp_path / "artifacts/reports/summary.log").write_text(
            "report\n", encoding="utf-8"
        )
        ref_report = tmp_path / "objects/x/artifacts/evidence/reference/eval/report.json"
        ref_report.write_text('{"passed": true}\n', encoding="utf-8")
    
        (tmp_path / "MANIFEST.json").write_text(
            json.dumps(
                {
                    "arsenal": {},
                    "objects": [],
                    "protocols": [],
                    "architecture": [],
                    "metrics": {},
                    "checksums": {},
                }
            )
            + "\n",
            encoding="utf-8",
        )
    
        subprocess.run(
            [
                "git",
                "add",
                "src/stable.txt",
                "objects/x/artifacts/evidence/reference/eval/report.json",
                "MANIFEST.json",
            ],
            cwd=tmp_path,
            check=True,
            capture_output=True,
            text=True,
        )
    
        proc = run_rebuild(tmp_path)
>       assert proc.returncode == 0, proc.stdout + "\n" + proc.stderr
E       AssertionError: 
E         /root/.pyenv/versions/3.13.8/bin/python: can't open file '/workspace/Agent-X-Lab/scripts/rebuild_checksums.py': [Errno 2] No such file or directory
E         
E       assert 2 == 0
E        +  where 2 = CompletedProcess(args=['/root/.pyenv/versions/3.13.8/bin/python', 'scripts/rebuild_checksums.py', '--repo-root', '/tmp.../python: can't open file '/workspace/Agent-X-Lab/scripts/rebuild_checksums.py': [Errno 2] No such file or directory\n").returncode

engine/tests/test_rebuild_checksums.py:89: AssertionError
______________ test_rebuild_checksums_uses_git_tracked_files_only ______________

tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/test_rebuild_checksums_uses_gi0')

    def test_rebuild_checksums_uses_git_tracked_files_only(tmp_path: Path) -> None:
        subprocess.run(
            ["git", "init"], cwd=tmp_path, check=True, capture_output=True, text=True
        )
        subprocess.run(
            ["git", "config", "user.email", "test@example.com"],
            cwd=tmp_path,
            check=True,
            capture_output=True,
            text=True,
        )
        subprocess.run(
            ["git", "config", "user.name", "Test User"],
            cwd=tmp_path,
            check=True,
            capture_output=True,
            text=True,
        )
    
        (tmp_path / "tracked.txt").write_text("tracked\n", encoding="utf-8")
        (tmp_path / "MANIFEST.json").write_text(
            json.dumps(
                {
                    "arsenal": {},
                    "objects": [],
                    "protocols": [],
                    "architecture": [],
                    "metrics": {},
                    "checksums": {},
                }
            )
            + "\n",
            encoding="utf-8",
        )
        subprocess.run(
            ["git", "add", "tracked.txt", "MANIFEST.json"],
            cwd=tmp_path,
            check=True,
            capture_output=True,
            text=True,
        )
    
        (tmp_path / "untracked.txt").write_text("temp\n", encoding="utf-8")
    
        proc = run_rebuild(tmp_path)
>       assert proc.returncode == 0, proc.stdout + "\n" + proc.stderr
E       AssertionError: 
E         /root/.pyenv/versions/3.13.8/bin/python: can't open file '/workspace/Agent-X-Lab/scripts/rebuild_checksums.py': [Errno 2] No such file or directory
E         
E       assert 2 == 0
E        +  where 2 = CompletedProcess(args=['/root/.pyenv/versions/3.13.8/bin/python', 'scripts/rebuild_checksums.py', '--repo-root', '/tmp.../python: can't open file '/workspace/Agent-X-Lab/scripts/rebuild_checksums.py': [Errno 2] No such file or directory\n").returncode

engine/tests/test_rebuild_checksums.py:154: AssertionError
_____________________ test_validate_arsenal_strict_passes ______________________

    def test_validate_arsenal_strict_passes() -> None:
        p = run(["python", "scripts/validate_arsenal.py", "--repo-root", ".", "--strict"])
>       assert p.returncode == 0, p.stdout + "\n" + p.stderr
E       AssertionError: {
E           "passed": false,
E           "strict": true,
E           "checks_total": 262,
E           "checks_passed": 250,
E           "checks_failed": 12,
E           "failed_checks": [
E             {
E               "id": "R20",
E               "passed": false,
E               "details": "required root path exists: .github/workflows/ci.yml"
E             },
E             {
E               "id": "R21",
E               "passed": false,
E               "details": "required root path exists: .github/workflows/security.yml"
E             },
E             {
E               "id": "R22",
E               "passed": false,
E               "details": "required root path exists: .github/workflows/lint-actions.yml"
E             },
E             {
E               "id": "C009.T",
E               "passed": false,
E               "details": "checksum path must be git-tracked stable file: .github/workflows/lint-actions.yml"
E             },
E             {
E               "id": "C010.T",
E               "passed": false,
E               "details": "checksum path must be git-tracked stable file: .github/workflows/scorecard.yml"
E             },
E             {
E               "id": "C011.T",
E               "passed": false,
E               "details": "checksum path must be git-tracked stable file: .github/workflows/security.yml"
E             },
E             {
E               "id": "C040",
E               "passed": false,
E               "details": "sha256 matches: catalog/agents/Agent-X-Lab_Integrated_Deterministic_PR_Orchestrator_v2026.03-kernel.md"
E             },
E             {
E               "id": "C042",
E               "passed": false,
E               "details": "sha256 matches: catalog/agents/CA-ERG_v2026.4_SYSTEM_PROMPT.md"
E             },
E             {
E               "id": "C043",
E               "passed": false,
E               "details": "sha256 matches: catalog/agents/CODEX_PFRI_v2026.5.0.md"
E             },
E             {
E               "id": "C046",
E               "passed": false,
E               "details": "sha256 matches: catalog/agents/VSMO_v2026.1.0.md"
E             },
E             {
E               "id": "C049",
E               "passed": false,
E               "details": "sha256 matches: catalog/index.json"
E             },
E             {
E               "id": "C063",
E               "passed": false,
E               "details": "sha256 matches: exoneural_governor/cli.py"
E             }
E           ]
E         }
E         
E         
E       assert 1 == 0
E        +  where 1 = CompletedProcess(args=['python', 'scripts/validate_arsenal.py', '--repo-root', '.', '--strict'], returncode=1, stdout=...3",\n      "passed": false,\n      "details": "sha256 matches: exoneural_governor/cli.py"\n    }\n  ]\n}\n', stderr='').returncode

engine/tests/test_repo_invariants.py:21: AssertionError
________________________ test_required_workflows_exist _________________________

    def test_required_workflows_exist() -> None:
        required = [
            REPO_ROOT / ".github/workflows/ci.yml",
            REPO_ROOT / ".github/workflows/security.yml",
            REPO_ROOT / ".github/workflows/lint-actions.yml",
        ]
        missing = [str(p.relative_to(REPO_ROOT)) for p in required if not p.exists()]
>       assert missing == [], f"missing workflows: {missing}"
E       AssertionError: missing workflows: ['.github/workflows/ci.yml', '.github/workflows/security.yml', '.github/workflows/lint-actions.yml']
E       assert ['.github/wor...-actions.yml'] == []
E         
E         Left contains 3 more items, first extra item: '.github/workflows/ci.yml'
E         Use -v to get more diff

engine/tests/test_repo_invariants.py:64: AssertionError
____________ test_run_gate_writes_default_evidence_under_repo_root _____________

tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/test_run_gate_writes_default_e0')

    def test_run_gate_writes_default_evidence_under_repo_root(tmp_path: Path) -> None:
        target_cwd = REPO_ROOT / "tests"
        run_cwd = tmp_path / "outside"
        run_cwd.mkdir()
    
        evidence = REPO_ROOT / "artifacts" / "agent" / "evidence.jsonl"
        before = evidence.read_text(encoding="utf-8") if evidence.exists() else ""
    
        _run_with_cwd(
            run_cwd=run_cwd,
            target_cwd=target_cwd,
            stdout=tmp_path / "out1.txt",
            stderr=tmp_path / "err1.txt",
        )
    
        assert evidence.exists()
        after = evidence.read_text(encoding="utf-8")
>       assert len(after) > len(before)
E       assert 90228 > 90228
E        +  where 90228 = len('{"ts_utc": "2026-02-21T12:55:49Z", "cmd": "git status --short", "cwd": "/workspace/Agent-X-Lab", "exit": 0, "duration...derr_tail_sha256":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","produced_paths":[],"notes":""}\n')
E        +  and   90228 = len('{"ts_utc": "2026-02-21T12:55:49Z", "cmd": "git status --short", "cwd": "/workspace/Agent-X-Lab", "exit": 0, "duration...derr_tail_sha256":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","produced_paths":[],"notes":""}\n')

engine/tests/test_run_gate.py:88: AssertionError
____________ test_run_gate_default_evidence_path_stable_across_cwds ____________

tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/test_run_gate_default_evidence0')

    def test_run_gate_default_evidence_path_stable_across_cwds(tmp_path: Path) -> None:
        target_cwd = REPO_ROOT / "tests"
        evidence = REPO_ROOT / "artifacts" / "agent" / "evidence.jsonl"
    
        start = evidence.read_text(encoding="utf-8") if evidence.exists() else ""
    
        run_cwd_a = tmp_path / "a"
        run_cwd_b = tmp_path / "b"
        run_cwd_a.mkdir()
        run_cwd_b.mkdir()
    
        _run_with_cwd(
            run_cwd=run_cwd_a,
            target_cwd=target_cwd,
            stdout=tmp_path / "out_a.txt",
            stderr=tmp_path / "err_a.txt",
        )
        _run_with_cwd(
            run_cwd=run_cwd_b,
            target_cwd=target_cwd,
            stdout=tmp_path / "out_b.txt",
            stderr=tmp_path / "err_b.txt",
        )
    
        lines = evidence.read_text(encoding="utf-8")[len(start) :].strip().splitlines()
>       assert len(lines) >= 2
E       assert 0 >= 2
E        +  where 0 = len([])

engine/tests/test_run_gate.py:117: AssertionError
__________ test_run_gate_relative_evidence_file_is_repo_root_anchored __________

tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/test_run_gate_relative_evidenc0')

    def test_run_gate_relative_evidence_file_is_repo_root_anchored(tmp_path: Path) -> None:
        target_cwd = REPO_ROOT / "tests"
        run_cwd = tmp_path / "outside"
        run_cwd.mkdir()
    
        rel_evidence = "artifacts/agent/custom-evidence.jsonl"
        repo_evidence_path = REPO_ROOT / rel_evidence
        if repo_evidence_path.exists():
            repo_evidence_path.unlink()
    
        _run_with_relative_evidence_file(
            run_cwd=run_cwd,
            target_cwd=target_cwd,
            evidence_file=rel_evidence,
            stdout=tmp_path / "out_custom.txt",
            stderr=tmp_path / "err_custom.txt",
        )
    
>       assert repo_evidence_path.exists()
E       AssertionError: assert False
E        +  where False = exists()
E        +    where exists = PosixPath('/workspace/Agent-X-Lab/engine/artifacts/agent/custom-evidence.jsonl').exists

engine/tests/test_run_gate.py:141: AssertionError
____________ test_scorecard_workflow_has_fail_closed_sarif_contract ____________

    def test_scorecard_workflow_has_fail_closed_sarif_contract() -> None:
        workflow_path = REPO_ROOT / ".github/workflows/scorecard.yml"
>       workflow = yaml.safe_load(workflow_path.read_text(encoding="utf-8"))
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

engine/tests/test_workflow_guards.py:103: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/root/.pyenv/versions/3.13.8/lib/python3.13/pathlib/_local.py:546: in read_text
    return PathBase.read_text(self, encoding, errors, newline)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/root/.pyenv/versions/3.13.8/lib/python3.13/pathlib/_abc.py:632: in read_text
    with self.open(mode='r', encoding=encoding, errors=errors, newline=newline) as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = PosixPath('/workspace/Agent-X-Lab/engine/.github/workflows/scorecard.yml')
mode = 'r', buffering = -1, encoding = 'utf-8', errors = None, newline = None

    def open(self, mode='r', buffering=-1, encoding=None,
             errors=None, newline=None):
        """
        Open the file pointed to by this path and return a file object, as
        the built-in open() function does.
        """
        if "b" not in mode:
            encoding = io.text_encoding(encoding)
>       return io.open(self, mode, buffering, encoding, errors, newline)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       FileNotFoundError: [Errno 2] No such file or directory: '/workspace/Agent-X-Lab/engine/.github/workflows/scorecard.yml'

/root/.pyenv/versions/3.13.8/lib/python3.13/pathlib/_local.py:537: FileNotFoundError
=========================== short test summary info ============================
FAILED engine/tests/test_config.py::test_load_config_rejects_repo_root_without_pyproject
FAILED engine/tests/test_doctor.py::test_quickstart_script_exists_and_executable
FAILED engine/tests/test_readme_contract.py::test_readme_contract_passes - As...
FAILED engine/tests/test_readme_contract.py::test_generate_titan9_proof_bundle
FAILED engine/tests/test_rebuild_checksums.py::test_rebuild_checksums_excludes_transient_artifact_paths
FAILED engine/tests/test_rebuild_checksums.py::test_rebuild_checksums_uses_git_tracked_files_only
FAILED engine/tests/test_repo_invariants.py::test_validate_arsenal_strict_passes
FAILED engine/tests/test_repo_invariants.py::test_required_workflows_exist - ...
FAILED engine/tests/test_run_gate.py::test_run_gate_writes_default_evidence_under_repo_root
FAILED engine/tests/test_run_gate.py::test_run_gate_default_evidence_path_stable_across_cwds
FAILED engine/tests/test_run_gate.py::test_run_gate_relative_evidence_file_is_repo_root_anchored
FAILED engine/tests/test_workflow_guards.py::test_scorecard_workflow_has_fail_closed_sarif_contract
EXIT_CODE=1
